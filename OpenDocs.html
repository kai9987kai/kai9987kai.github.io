<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Word Processor - Advanced & Innovative</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/> <!-- Animate.css for effects -->
    <style>
        /* Existing CSS (from previous improved version) - keep all of it */
        body {
            margin: 0;
            font-family: sans-serif;
            background-color: #f4f7f9;
            color: #333;
        }

        .ribbon {
            background-color: #fff;
            border-bottom: 1px solid #e0e0e0;
            padding: 10px 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tabs {
            display: flex;
            gap: 5px;
        }

        .tab-button {
            padding: 8px 15px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-bottom: none;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
            font-size: 0.9em;
            transition: background-color 0.2s;
        }

        .tab-button:hover {
            background-color: #e0e0e0;
        }

        .tab-button.active {
            background-color: #fff;
            border-bottom: 1px solid #fff;
        }

        .tab-content {
            display: none;
            background-color: #fff;
            padding: 20px;
            border: 1px solid #ccc;
            border-top: none;
            border-radius: 0 0 5px 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .group {
            display: inline-block;
            vertical-align: top;
            margin-right: 15px;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            background-color: #f9f9f9;
        }

        .group h3 {
            margin: 0 0 8px;
            font-size: 0.85em;
            color: #555;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .group button, .group select, .group input {
            margin: 3px;
            padding: 6px 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
            cursor: pointer;
            background-color: #fff;
            font-size: 0.9em;
            transition: background-color 0.2s, border-color 0.2s;
        }

        .group button:hover, .group select:hover, .group input:hover {
            background-color: #f0f0f0;
            border-color: #b0b0b0;
        }

        .group button.active-format {
            background-color: #e0e0e0;
        }

        .group input[type="number"] {
            width: 40px;
        }

        .document {
            margin: 20px;
            padding: 20px;
            background-color: white;
            min-height: 500px;
            border: 1px solid #ccc;
            box-shadow: 0 0 10px rgba(0,0,0,0.08);
            outline: none;
            border-radius: 5px;
            font-size: 16px;
            line-height: 1.6;
        }

        .right-menu {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .color-picker-group {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .color-picker-label {
            font-size: 0.9em;
            color: #555;
        }

        .color-picker {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            border: 1px solid #ccc;
            border-radius: 3px;
            background-color: #fff;
            cursor: pointer;
            padding: 0;
        }

        .color-picker::-webkit-color-swatch-wrapper {
            padding: 2px;
        }
        .color-picker::-webkit-color-swatch {
            border: none;
            border-radius: 2px;
        }
        .color-picker::-moz-color-swatch-wrapper {
            padding: 2px;
        }
        .color-picker::-moz-color-swatch {
            border: none;
            border-radius: 2px;
        }

        .group button.list-button {
            width: 30px;
            text-align: center;
        }

        .group button.indent-button {
            width: 30px;
            text-align: center;
        }

        .group button#clearFormatting {
            font-size: 0.8em;
        }

        /* --- NEW CSS for Advanced Features --- */
        #view-tab-content { /* Specific ID for View Tab Content */
            display: none;
        }

        #review-tab-content { /* Specific ID for Review Tab Content */
            display: none;
        }

        .zoom-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .zoom-controls button {
            padding: 5px 10px;
            font-size: 0.9em;
        }

        #zoom-level {
            font-size: 0.9em;
            width: 40px;
            text-align: center;
            border: none;
            background-color: transparent;
        }

        .find-replace-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .find-replace-group input {
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        .find-replace-group button {
            padding: 6px 10px;
        }

        .styles-dropdown-group {
            position: relative; /* For dropdown positioning */
            display: inline-block;
        }

        .styles-dropdown-button {
            padding: 6px 10px;
        }

        .styles-dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            border: 1px solid #ccc;
            border-radius: 3px;
            padding: 5px 0;
        }

        .styles-dropdown-content button {
            display: block;
            width: 100%;
            padding: 8px 16px;
            text-align: left;
            border: none;
            background-color: transparent;
            cursor: pointer;
        }

        .styles-dropdown-content button:hover {
            background-color: #e0e0e0;
        }

        .styles-dropdown-group:hover .styles-dropdown-content {
            display: block;
        }

        .template-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); /* Responsive template grid */
            gap: 15px;
            padding: 10px;
        }

        .template-preview {
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            background-color: #fff;
            transition: transform 0.2s;
        }

        .template-preview:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .template-preview h4 {
            margin-top: 0;
            font-size: 1em;
        }

        /* Track Changes Styling */
        .track-changes-highlight {
            background-color: rgba(255, 200, 200, 0.5); /* Light red for deletions */
            text-decoration: line-through;
        }
        .track-changes-insertion {
            background-color: rgba(200, 255, 200, 0.5); /* Light green for insertions */
        }
        .comment-bubble {
            display: inline-block;
            background-color: #ffeb3b; /* Yellow comment bubble */
            border-radius: 50%;
            width: 15px;
            height: 15px;
            text-align: center;
            line-height: 15px;
            font-size: 0.8em;
            color: #333;
            cursor: pointer;
            margin-left: 3px;
        }

        /* --- NEW CSS for Advanced Find & Replace --- */
        .find-replace-group.advanced {
            flex-direction: row; /* Arrange inputs and button horizontally */
            align-items: center; /* Vertically align items */
        }

        .find-replace-group.advanced input {
            margin-right: 5px; /* Add some spacing between inputs */
        }

        .find-options {
            display: flex;
            gap: 10px;
            margin-top: 5px;
        }

        .find-options label {
            font-size: 0.85em;
            color: #555;
            display: flex;
            align-items: center;
            gap: 3px;
        }

        /* --- New Styles for AI Features --- */
        .ai-suggestion-popup {
            position: absolute;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            padding: 10px;
            z-index: 2;
            display: none; /* Hidden by default */
        }

        .ai-suggestion-popup button {
            display: block;
            width: 100%;
            padding: 8px 10px;
            text-align: left;
            border: none;
            background-color: transparent;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .ai-suggestion-popup button:hover {
            background-color: #e0e0e0;
        }

        .smart-compose-highlight {
            background-color: rgba(220, 240, 255, 0.7); /* Light blue highlight for smart compose suggestions */
        }

        /* Styles for Collaboration Features */
        .collaborator-cursor {
            position: absolute;
            height: 1.2em; /* Adjust to match line height */
            width: 2px;
            background-color: blue; /* Example cursor color */
            pointer-events: none; /* Prevent interfering with text selection */
        }
        .collaborator-name-tag {
            position: absolute;
            top: -1.5em; /* Position above the cursor */
            background-color: blue; /* Match cursor color */
            color: white;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 0.8em;
            pointer-events: none;
        }


    </style>
</head>
<body>
    <div class="ribbon">
        <div class="tabs">
            <button class="tab-button active" data-tab="file">File</button>
            <button class="tab-button" data-tab="home">Home</button>
            <button class="tab-button" data-tab="insert">Insert</button>
            <button class="tab-button" data-tab="layout">Layout</button>
            <button class="tab-button" data-tab="review">Review</button>
            <button class="tab-button" data-tab="view">View</button>
            <button class="tab-button" data-tab="ai">AI Tools</button>   <!-- New AI Tools Tab -->
            <button class="tab-button" data-tab="collaborate">Collaborate</button> <!-- New Collaborate Tab -->
            <button class="tab-button" data-tab="tools">Tools</button>
            <!-- More tabs can be added here -->
        </div>
        <div class="right-menu">
            <div class="color-picker-group">
                <label for="textColorPicker" class="color-picker-label">Text Color:</label>
                <input type="color" id="textColorPicker" class="color-picker" value="#000000" onchange="changeTextColor(this.value)">
            </div>
            <div class="color-picker-group">
                <label for="highlightColorPicker" class="color-picker-label">Highlight:</label>
                <input type="color" id="highlightColorPicker" class="color-picker" value="#ffff00" onchange="changeHighlightColor(this.value)">
            </div>
            <!-- Add more right-side menu items as needed -->
        </div>
    </div>

    <div class="tab-content" id="file">
        <div class="group">
            <h3>File Actions</h3>
            <button onclick="newDocument()">New</button>
            <button onclick="saveDocument()">Save</button>
            <button onclick="openDocument()">Open</button>
            <button onclick="exportDocument('docx')">Export as DOCX</button>
            <button onclick="exportDocument('pdf')">Export as PDF</button>
            <button onclick="printDocument()">Print</button> <!-- Print Functionality -->
        </div>
        <div class="group">
            <h3>Templates</h3>
            <div class="styles-dropdown-group">
                <button class="styles-dropdown-button" onclick="toggleTemplateGallery()">Templates <i class="fas fa-caret-down"></i></button>
                <div class="styles-dropdown-content" id="templatesDropdown">
                    <!-- Templates will be loaded here by JavaScript -->
                </div>
            </div>
        </div>
        <div class="group">
            <h3>Document Info</h3>
            <button onclick="wordCount()">Word Count</button>
            <button onclick="characterCount()">Character Count</button>
            <button onclick="pageCount()">Page Count</button> <!-- Page Count -->
            <button onclick="documentStats()">Document Stats</button> <!-- Detailed Document Stats -->
        </div>
    </div>

    <div class="tab-content" id="home">
        <div class="group">
            <h3>Font</h3>
            <select onchange="changeFont(this.value)">
                <option value="Arial">Arial</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Courier New">Courier New</option>
                <option value="Verdana">Verdana</option>
                <option value="Georgia">Georgia</option>
                <option value="Calibri">Calibri</option>
                <option value="Segoe UI">Segoe UI</option>
                <option value="Roboto">Roboto</option>     <!-- Added Roboto -->
                <option value="Open Sans">Open Sans</option> <!-- Added Open Sans -->
            </select>
            <input type="number" value="16" min="8" max="72" style="width: 50px;" onchange="changeFontSize(this.value)">
            <button onclick="formatText('bold')" id="boldButton"><b>B</b></button>
            <button onclick="formatText('italic')" id="italicButton"><i>I</i></button>
            <button onclick="formatText('underline')" id="underlineButton"><u>U</u></button>
            <button onclick="formatText('strikeThrough')" id="strikeButton"><strike>S</strike></button>
            <button onclick="formatText('superscript')" id="superscriptButton">X<sup>2</sup></button>
            <button onclick="formatText('subscript')" id="subscriptButton">X<sub>2</sub></button>
            <button onclick="changeTextCase('uppercase')">Aa <i class="fas fa-arrow-up"></i></button> <!-- Uppercase -->
            <button onclick="changeTextCase('lowercase')">aa <i class="fas fa-arrow-down"></i></button> <!-- Lowercase -->
            <button onclick="clearFormatting()" id="clearFormatting">Clear Format</button>
        </div>
        <div class="group">
            <h3>Paragraph</h3>
            <div class="styles-dropdown-group">
                <button class="styles-dropdown-button">Styles <i class="fas fa-caret-down"></i></button>
                <div class="styles-dropdown-content" id="stylesDropdown">
                    <button onclick="applyStyle('Heading 1')">Heading 1</button>
                    <button onclick="applyStyle('Heading 2')">Heading 2</button>
                    <button onclick="applyStyle('Heading 3')">Heading 3</button>
                    <button onclick="applyStyle('Heading 4')">Heading 4</button>
                    <button onclick="applyStyle('Heading 5')">Heading 5</button>
                    <button onclick="applyStyle('Heading 6')">Heading 6</button>
                    <button onclick="applyStyle('Normal')">Normal</button>
                    <button onclick="applyStyle('Quote')">Quote</button>
                    <button onclick="applyStyle('List Paragraph')">List Paragraph</button>
                    <button onclick="applyStyle('Code')">Code</button>
                    <button onclick="applyStyle('Intense Quote')">Intense Quote</button> <!-- Added Intense Quote -->
                    <button onclick="applyStyle('Subtitle')">Subtitle</button>       <!-- Added Subtitle -->
                </div>
            </div>
            <button onclick="alignText('left')"><i class="fas fa-align-left"></i></button>
            <button onclick="alignText('center')"><i class="fas fa-align-center"></i></button>
            <button onclick="alignText('right')"><i class="fas fa-align-right"></i></button>
            <button onclick="alignText('justify')"><i class="fas fa-align-justify"></i></button>
            <button onclick="formatText('insertUnorderedList')" class="list-button"><i class="fas fa-list-ul"></i></button>
            <button onclick="formatText('insertOrderedList')" class="list-button"><i class="fas fa-list-ol"></i></button>
            <button onclick="formatText('indent')" class="indent-button"><i class="fas fa-indent"></i></button>
            <button onclick="formatText('outdent')" class="indent-button"><i class="fas fa-outdent"></i></button>
            <button onclick="setLineSpacing('1.0')">1.0x Spacing</button>
            <button onclick="setLineSpacing('1.15')">1.15x Spacing</button>
            <button onclick="setLineSpacing('1.5')">1.5x Spacing</button>
            <button onclick="setLineSpacing('2.0')">2.0x Spacing</button>
            <button onclick="showParagraphSettings()">Paragraph Options</button>
            <button onclick="showBordersAndShading()">Borders & Shading</button> <!-- Borders and Shading -->
        </div>
        <div class="group">
            <h3>Clipboard</h3>
            <button onclick="formatText('cut')"><i class="fas fa-cut"></i> Cut</button>
            <button onclick="formatText('copy')"><i class="fas fa-copy"></i> Copy</button>
            <button onclick="formatText('paste')"><i class="fas fa-paste"></i> Paste</button>
            <button onclick="pasteSpecial()">Paste Special</button>
            <button onclick="formatPainter()">Format Painter</button> <!-- Format Painter -->
        </div>
        <div class="group">
            <h3>Editing</h3>
            <button onclick="formatText('undo')"><i class="fas fa-undo"></i> Undo</button>
            <button onclick="formatText('redo')"><i class="fas fa-redo"></i> Redo</button>
            <div class="find-replace-group advanced">
                <input type="text" id="findText" placeholder="Find">
                <input type="text" id="replaceText" placeholder="Replace">
                <button onclick="findAndReplace()">Find & Replace</button>
            </div>
            <div class="find-options">
                <label><input type="checkbox" id="caseSensitive"> Case Sensitive</label>
                <label><input type="checkbox" id="wholeWord"> Whole Word</label>
                <label><input type="checkbox" id="useRegex"> Use Regex</label>
            </div>
            <button onclick="goToLine()">Go To Line</button>
            <button onclick="selectAll()">Select All</button> <!-- Select All -->
        </div>
    </div>

    <div class="tab-content" id="insert">
        <div class="group">
            <h3>Pages</h3>
            <button onclick="insertCoverPage()">Cover Page</button> <!-- Cover Page -->
            <button onclick="insertBlankPage()">Blank Page</button> <!-- Blank Page -->
            <button onclick="insertPageBreak()">Page Break</button>
        </div>
        <div class="group">
            <h3>Tables</h3>
            <button onclick="insertTable()">Insert Table</button>
            <button onclick="drawTable()">Draw Table</button>
            <button onclick="insertExcelSpreadsheet()">Excel Spreadsheet</button> <!-- Embed Excel -->
            <button onclick="insertPredefinedTable()">Quick Tables</button>
        </div>
        <div class="group">
            <h3>Illustrations</h3>
            <button onclick="insertImage()">Insert Image</button>
            <button onclick="insertOnlineImage()">Online Pictures</button>
            <button onclick="insertShape()">Insert Shape</button>
            <button onclick="insertIcons()">Icons</button>          <!-- Icons -->
            <button onclick="insert3DModel()">3D Models</button>     <!-- 3D Models -->
            <button onclick="insertSmartArt()">SmartArt</button>
            <button onclick="insertChart()">Insert Chart</button>
            <button onclick="insertScreenshot()">Screenshot</button>
        </div>
        <div class="group">
            <h3>Add-ins</h3>
            <button onclick="getAddIns()">Get Add-ins</button>
            <button onclick="myAddIns()">My Add-ins</button>
            <button onclick="storeLink()">Store</button>          <!-- Store Link -->
            <button onclick="wikipediaLink()">Wikipedia</button>    <!-- Wikipedia Link -->
        </div>
        <div class="group">
            <h3>Links & Media</h3>
            <button onclick="insertLink()">Insert Link</button>
            <button onclick="insertBookmark()">Bookmark</button>
            <button onclick="insertComment()">Comment</button>
            <button onclick="insertOnlineVideo()">Online Video</button> <!-- Online Video -->
        </div>
        <div class="group">
            <h3>Symbols</h3>
            <button onclick="insertEquation()">Equation</button>
            <button onclick="insertSymbol()">Symbol</button>
        </div>
        <div class="group">
            <h3>Header & Footer & Text</h3>
            <button onclick="insertHeader()">Header</button>
            <button onclick="insertFooter()">Footer</button>
            <button onclick="insertPageNumber()">Page Number</button>
            <button onclick="insertTextBox()">Text Box</button>     <!-- Text Box -->
            <button onclick="insertQuickParts()">Quick Parts</button> <!-- Quick Parts -->
            <button onclick="insertWordArt()">WordArt</button>     <!-- WordArt -->
            <button onclick="insertSignatureLine()">Signature Line</button> <!-- Signature Line -->
            <button onclick="insertDateAndTime()">Date & Time</button> <!-- Date & Time -->
            <button onclick="insertObject()">Object</button>        <!-- Object -->
        </div>
        <div class="group">
            <h3>Breaks</h3>
            <button onclick="insertPageBreak()">Page Break</button>
            <button onclick="insertSectionBreak()">Section Break</button>
            <button onclick="insertColumnBreak()">Column Break</button>
            <button onclick="insertTextWrappingBreak()">Text Wrapping Break</button>
        </div>
    </div>

    <div class="tab-content" id="layout">
        <div class="group">
            <h3>Page Setup</h3>
            <select>
                <option>Margins</option>
                <option>Narrow</option>
                <option>Moderate</option>
                <option>Wide</option>
                <option>Custom Margins...</option>
            </select>
            <select>
                <option>Orientation</option>
                <option>Portrait</option>
                <option>Landscape</option>
            </select>
            <select>
                <option>Size</option>
                <option>Letter</option>
                <option>A4</option>
                <option>Legal</option>
                <option>More Paper Sizes...</option>
            </select>
            <select>
                <option>Columns</option>
                <option>One</option>
                <option>Two</option>
                <option>Three</option>
                <option>More Columns...</option>
            </select>
            <button onclick="breaksDropdown()">Breaks</button>
            <button onclick="lineNumbering()">Line Numbers</button>
            <button onclick="hyphenation()">Hyphenation</button>
        </div>
        <div class="group">
            <h3>Paragraph (Layout)</h3>
            <input type="number" placeholder="Indent Left" style="width: 80px;">
            <input type="number" placeholder="Indent Right" style="width: 80px;">
            <input type="number" placeholder="Spacing Before" style="width: 90px;">
            <input type="number" placeholder="Spacing After" style="width: 90px;">
            <button onclick="positionSettings()">Position</button>
            <button onclick="wrapTextSettings()">Wrap Text</button>
            <button onclick="bringForward()">Bring Forward</button>
            <button onclick="sendBackward()">Send Backward</button>
            <button onclick="selectionPane()">Selection Pane</button>
            <button onclick="alignObjects()">Align</button>
            <button onclick="groupObjects()">Group</button>
            <button onclick="rotateObjects()">Rotate</button>
        </div>
    </div>

    <div class="tab-content" id="review">
        <div class="group">
            <h3>Proofing</h3>
            <button onclick="checkSpellingAndGrammar()">Spelling & Grammar</button>
            <button onclick="openThesaurus()">Thesaurus</button>
            <button onclick="smartLookup()">Smart Lookup</button> <!-- Smart Lookup -->
            <button onclick="wordCount()">Word Count</button>
            <button onclick="characterCount()">Character Count</button>
            <button onclick="readingLevel()">Reading Level</button>
            <button onclick="translateDocument()">Translate</button>
            <button onclick="languageSettings()">Language</button>
        </div>
        <div class="group">
            <h3>Accessibility & Comments</h3>
            <button onclick="checkAccessibility()">Check Accessibility</button>
            <button onclick="newComment()">New Comment</button>
            <button onclick="showComments()">Show Comments</button>
            <button onclick="trackComments()">Track Comments</button>
            <button onclick="deleteComment()">Delete</button>
            <button onclick="previousComment()">Previous</button>
            <button onclick="nextComment()">Next</button>
        </div>
        <div class="group">
            <h3>Track Changes & Compare</h3>
            <button onclick="toggleTrackChanges()">Track Changes</button>
            <button onclick="reviewChanges()">Reviewing Pane</button>
            <button onclick="acceptChanges()">Accept</button>
            <button onclick="rejectChanges()">Reject</button>
            <button onclick="previousChange()">Previous</button>
            <button onclick="nextChange()">Next</button>
            <button onclick="compareDocuments()">Compare</button> <!-- Compare Documents -->
            <button onclick="combineDocuments()">Combine</button> <!-- Combine Documents -->
        </div>
        <div class="group">
            <h3>Protect</h3>
            <button onclick="protectDocument()">Protect Document</button>
            <button onclick="restrictEditing()">Restrict Editing</button>
        </div>
        <div class="group">
            <h3>Ink</h3>
            <button onclick="startInking()">Start Inking</button> <!-- Start Inking - for drawing/annotation -->
            <select>
                <option>Ink Color</option>       <!-- Ink Color Selector -->
                <option>Black</option>
                <option>Red</option>
                <option>Blue</option>
            </select>
            <select>
                <option>Ink Thickness</option>   <!-- Ink Thickness Selector -->
                <option>Thin</option>
                <option>Medium</option>
                <option>Thick</option>
            </select>
            <button onclick="inkEraser()">Eraser</button>        <!-- Ink Eraser -->
        </div>
    </div>

    <div class="tab-content" id="view">
        <div class="group">
            <h3>Views</h3>
            <button onclick="toggleReadMode()">Read Mode</button>
            <button onclick="togglePrintLayout()">Print Layout</button>
            <button onclick="toggleWebLayout()">Web Layout</button>
            <button onclick="toggleOutlineView()">Outline</button>    <!-- Outline View -->
            <button onclick="toggleDraftView()">Draft</button>      <!-- Draft View -->
            <button onclick="toggleFullScreen()">Full Screen</button>
            <button onclick="immersiveReader()">Immersive Reader</button> <!-- Immersive Reader -->
        </div>
        <div class="group">
            <h3>Show</h3>
            <button onclick="showRuler()">Ruler</button>
            <button onclick="showGridlines()">Gridlines</button>
            <button onclick="showNavigationPane()">Navigation Pane</button>
            <button onclick="showStatusBar()">Status Bar</button>     <!-- Status Bar -->
        </div>
        <div class="group">
            <h3>Zoom & Window</h3>
            <div class="zoom-controls">
                <button onclick="zoomIn()">+</button>
                <input type="text" id="zoom-level" value="100%" readonly>
                <button onclick="zoomOut()">-</button>
                <button onclick="resetZoom()">100%</button>
            </div>
            <button onclick="newWindow()">New Window</button>
            <button onclick="arrangeWindows()">Arrange All</button>
            <button onclick="splitWindow()">Split</button>
            <button onclick="viewSideBySide()">View Side by Side</button> <!-- View Side by Side -->
            <button onclick="synchronousScrolling()">Synchronous Scrolling</button> <!-- Synchronous Scrolling -->
            <button onclick="resetWindowPosition()">Reset Window Position</button> <!-- Reset Window Position -->
            <button onclick="switchWindows()">Switch Windows</button>     <!-- Switch Windows -->
        </div>
        <div class="group">
            <h3>Macros</h3>
            <button onclick="recordMacro()">Record Macro</button>   <!-- Record Macro -->
            <button onclick="viewMacros()">View Macros</button>     <!-- View Macros -->
        </div>
    </div>

    <div class="tab-content" id="ai"> <!-- New AI Tools Tab Content -->
        <div class="group">
            <h3>AI Assistance</h3>
            <button onclick="smartComposeToggle()">Smart Compose <span id="smartComposeStatus">(Off)</span></button>
            <button onclick="grammarCheckAI()">AI Grammar Check</button>
            <button onclick="styleSuggestionsAI()">Style Suggestions</button>
            <button onclick="summarizeTextAI()">Summarize Text</button>
            <button onclick="translateAI()">Translate with AI</button>
            <button onclick="contentRewriteAI()">Rewrite Content</button>
            <button onclick="toneAdjustAI()">Adjust Tone</button>
        </div>
        <div class="group">
            <h3>Research & Ideas</h3>
            <button onclick="researchAI()">Research</button>
            <button onclick="ideasAI()">Ideas & Suggestions</button>
        </div>
    </div>

    <div class="tab-content" id="collaborate"> <!-- New Collaborate Tab Content -->
        <div class="group">
            <h3>Share & Collaborate</h3>
            <button onclick="shareDocument()">Share</button>
            <button onclick="collaborateRealtimeToggle()">Real-time Collaboration <span id="realtimeStatus">(Off)</span></button>
            <input type="text" placeholder="Invite Collaborators" id="collaboratorInput">
            <button onclick="inviteCollaborator()">Invite</button>
            <button onclick="managePermissions()">Manage Permissions</button>
            <button onclick="trackCollaborators()">Track Collaborators</button>
            <button onclick="startCoAuthoringSession()">Start Co-authoring Session</button>
            <button onclick="joinCoAuthoringSession()">Join Co-authoring Session</button>
        </div>
        <div class="group">
            <h3>Version History & Backup</h3>
            <button onclick="versionHistory()">Version History</button>
            <button onclick="autosaveToggle()">Autosave <span id="autosaveStatus">(On)</span></button>
            <button onclick="manualBackup()">Manual Backup</button>
            <button onclick="cloudSyncToggle()">Cloud Sync <span id="cloudSyncStatus">(Off)</span></button>
        </div>
    </div>


    <div class="tab-content" id="tools">
        <div class="group">
            <h3>Accessibility</h3>
            <button onclick="checkAccessibility()">Check Accessibility</button>
            <button onclick="accessibilitySettings()">Accessibility Settings</button> <!-- Accessibility Settings -->
        </div>
        <div class="group">
            <h3>Mailings</h3>
            <button onclick="mailMerge()">Mail Merge</button>
            <button onclick="envelopes()">Envelopes</button>
            <button onclick="labels()">Labels</button>
        </div>
        <div class="group">
            <h3>Document Conversion</h3>
            <button onclick="convertToPDF()">Convert to PDF</button>   <!-- Convert to PDF -->
            <button onclick="convertToDOCX()">Convert to DOCX</button> <!-- Convert to DOCX -->
            <button onclick="convertToHTML()">Convert to HTML</button> <!-- Convert to HTML -->
            <button onclick="convertToPlainText()">Convert to Plain Text</button> <!-- Convert to Plain Text -->
        </div>
        <div class="group">
            <h3>Options</h3>
            <button onclick="optionsDialog()">Options</button>
            <button onclick="customizeRibbon()">Customize Ribbon</button> <!-- Customize Ribbon -->
            <button onclick="keyboardShortcuts()">Keyboard Shortcuts</button> <!-- Keyboard Shortcuts -->
        </div>
    </div>


    <div class="document" contenteditable="true" oncontextmenu="showContextMenu(event)" oninput="handleDocumentInput(event)">Start typing here...</div>

    <!-- Context Menu (Hidden by default) -->
    <div id="contextMenu" style="position: fixed; z-index: 1; display:none; border: 1px solid #ccc; background-color: white; padding: 5px; border-radius: 3px; box-shadow: 2px 2px 5px rgba(0,0,0,0.2);">
        <button onclick="formatText('bold'); hideContextMenu()">Bold</button><br>
        <button onclick="formatText('italic'); hideContextMenu()">Italic</button><br>
        <button onclick="formatText('underline'); hideContextMenu()">Underline</button><br>
        <button onclick="formatText('copy'); hideContextMenu()">Copy</button><br>
        <button onclick="formatText('cut'); hideContextMenu()">Cut</button><br>
        <button onclick="pasteInContextMenu(); hideContextMenu()">Paste</button><br>
        <button onclick="insertComment(); hideContextMenu()">Add Comment</button><br>
        <button onclick="summarizeSelectionAI(); hideContextMenu()">Summarize (AI)</button><br> <!-- AI Summarize in Context Menu -->
        <button onclick="translateSelectionAI(); hideContextMenu()">Translate (AI)</button><br> <!-- AI Translate in Context Menu -->
    </div>

    <!-- AI Suggestion Popup -->
    <div id="aiSuggestionPopup" class="ai-suggestion-popup">
        <!-- Suggestions will be populated here by JavaScript -->
    </div>

    <!-- Collaborator Cursors Container -->
    <div id="collaboratorCursors"></div>


    <script>
        // --- JavaScript from previous improved version (Keep all of it) ---
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.style.display = 'none';
                });
                const tabId = button.getAttribute('data-tab');
                document.getElementById(tabId).style.display = 'block';
                button.classList.add('active');
            });
        });
        document.getElementById('file').style.display = 'block';
        document.querySelector('.tab-button[data-tab="file"]').classList.add('active');

        function formatText(command) {
            document.execCommand(command, false, null);
            updateFormatButtons();
        }

        function alignText(alignment) {
            document.execCommand('justify' + alignment.charAt(0).toUpperCase() + alignment.slice(1), false, null);
        }

        function changeFont(fontName) {
            document.execCommand('fontName', false, fontName);
        }

        function changeFontSize(size) {
            document.execCommand('fontSize', false, '7');
            const fontElements = document.querySelectorAll('font[size="7"]');
            fontElements.forEach(el => {
                const span = document.createElement('span');
                span.style.fontSize = size + 'px';
                span.innerHTML = el.innerHTML;
                el.parentNode.replaceChild(span, el);
            });
        }

        function changeTextColor(color) {
            document.execCommand('foreColor', false, color);
        }

        function changeHighlightColor(color) {
            document.execCommand('backColor', false, color);
        }

        function clearFormatting() {
            document.execCommand('removeFormat', false, null);
            updateFormatButtons();
        }

        function insertTable() {
            const rows = prompt('Enter number of rows:', '2');
            const cols = prompt('Enter number of columns:', '2');
            if (rows && cols) {
                let tableHtml = '<table border="1" style="border-collapse: collapse;">';
                for (let i = 0; i < rows; i++) {
                    tableHtml += '<tr>';
                    for (let j = 0; j < cols; j++) {
                        tableHtml += '<td style="padding: 5px;">Cell</td>';
                    }
                    tableHtml += '</tr>';
                }
                tableHtml += '</table>';
                document.execCommand('insertHTML', false, tableHtml);
            }
        }

        function insertImage() {
            const url = prompt('Enter image URL:');
            if (url) {
                document.execCommand('insertImage', false, url);
            }
        }

        function insertLink() {
            const url = prompt('Enter URL:');
            if (url) {
                document.execCommand('createLink', false, url);
            }
        }

        function insertHorizontalRule() {
            document.execCommand('insertHorizontalRule', false, null);
        }

        function newDocument() {
            document.querySelector('.document').innerHTML = '';
        }

        function saveDocument() {
            const content = document.querySelector('.document').innerHTML;
            const blob = new Blob([content], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'document.html';
            a.click();
            URL.revokeObjectURL(url);
        }

        function openDocument() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'text/html';
            input.onchange = function(event) {
                const file = event.target.files[0];
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.querySelector('.document').innerHTML = e.target.result;
                };
                reader.readAsText(file);
            };
            input.click();
        }

        function updateFormatButtons() {
            document.querySelectorAll('.group button[onclick^="formatText"]').forEach(button => {
                const command = button.getAttribute('onclick').match(/'([^']+)'/)[1];
                if (command === 'bold' || command === 'italic' || command === 'underline' || command === 'strikeThrough' || command === 'superscript' || command === 'subscript') {
                    if (document.queryCommandState(command)) {
                        button.classList.add('active-format');
                    } else {
                        button.classList.remove('active-format');
                    }
                }
            });
        }
        document.addEventListener('selectionchange', updateFormatButtons);
        document.addEventListener('DOMContentLoaded', updateFormatButtons);


        // --- NEW JavaScript for Advanced Features ---

        // Styles Dropdown
        document.addEventListener('DOMContentLoaded', () => {
            const stylesDropdownContent = document.getElementById('stylesDropdown');
            if (stylesDropdownContent) {
                stylesDropdownContent.style.display = 'none'; // Initially hide styles dropdown
            }
        });

        function applyStyle(styleName) {
            if (styleName === 'Heading 1') {
                applyFormatting('<h1 style="font-size: 2em; margin-bottom: 0.5em;">', '</h1>');
            } else if (styleName === 'Heading 2') {
                applyFormatting('<h2 style="font-size: 1.5em; margin-bottom: 0.5em;">', '</h2>');
            } else if (styleName === 'Heading 3') {
                applyFormatting('<h3 style="font-size: 1.17em; margin-bottom: 0.5em;">', '</h3>');
            } else if (styleName === 'Heading 4') {
                applyFormatting('<h4 style="font-size: 1.0em; margin-bottom: 0.5em; font-weight: bold;">', '</h4>'); // Example for Heading 4
            } else if (styleName === 'Heading 5') {
                applyFormatting('<h5 style="font-size: 0.9em; margin-bottom: 0.5em; font-weight: bold; font-style: italic;">', '</h5>'); // Example for Heading 5
            } else if (styleName === 'Heading 6') {
                applyFormatting('<h6 style="font-size: 0.8em; margin-bottom: 0.5em; font-weight: bold; color: #777;">', '</h6>'); // Example for Heading 6
            } else if (styleName === 'Normal') {
                applyFormatting('<p style="font-size: 1em; line-height: 1.6;">', '</p>');
            } else if (styleName === 'Quote') {
                applyFormatting('<blockquote style="border-left: 3px solid #ccc; margin-left: 10px; padding-left: 10px; font-style: italic;">', '</blockquote>');
            } else if (styleName === 'List Paragraph') {
                applyFormatting('<p style="margin-left: 20px;">', '</p>'); // Example for List Paragraph
            } else if (styleName === 'Code') {
                applyFormatting('<pre style="background-color: #f4f4f4; border: 1px solid #ddd; padding: 10px; font-family: monospace; font-size: 0.9em; border-radius: 3px; overflow-x: auto;">', '</pre>'); // Example for Code Style
            } else if (styleName === 'Intense Quote') {
                applyFormatting('<blockquote style="border-left: 5px solid #333; margin-left: 15px; padding-left: 15px; font-style: italic; font-weight: bold; color: #555;">', '</blockquote>');
            } else if (styleName === 'Subtitle') {
                applyFormatting('<h4 style="font-size: 1.2em; color: #666; margin-bottom: 0.3em; font-style: italic;">', '</h4>');
            }
            // Add more styles as needed
        }

        function applyFormatting(startTag, endTag) {
            const selection = window.getSelection();
            if (!selection.rangeCount) return;
            const range = selection.getRangeAt(0);
            const selectedText = range.toString();
            const formattedText = startTag + selectedText + endTag;

            // Delete the selected text and insert the formatted text
            range.deleteContents();
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = formattedText;
            const fragment = document.createDocumentFragment();
            while (tempDiv.firstChild) {
                fragment.appendChild(tempDiv.firstChild);
            }
            range.insertNode(fragment);
            selection.removeAllRanges(); // Clear selection
        }


        // Line Spacing
        function setLineSpacing(spacing) {
            document.querySelector('.document').style.lineHeight = spacing;
        }

        // Advanced Find and Replace
        function findAndReplace() {
            const findText = document.getElementById('findText').value;
            const replaceText = document.getElementById('replaceText').value;
            const documentElement = document.querySelector('.document');
            let regex;
            let flags = 'g'; // Global

            if (!document.getElementById('caseSensitive').checked) {
                flags += 'i'; // Case-insensitive
            }
            if (document.getElementById('useRegex').checked) {
                try {
                    regex = new RegExp(findText, flags);
                } catch (e) {
                    alert('Invalid Regular Expression.');
                    return;
                }
            } else {
                const escapedFindText = escapeRegExp(findText);
                if (document.getElementById('wholeWord').checked) {
                    regex = new RegExp('\\b' + escapedFindText + '\\b', flags); // Whole word
                } else {
                    regex = new RegExp(escapedFindText, flags);
                }
            }

            documentElement.innerHTML = documentElement.innerHTML.replace(regex, replaceText);
        }

        function escapeRegExp(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); // Escape special characters for RegExp
        }


        // Zoom Functionality
        let currentZoom = 100;
        const zoomStep = 10;
        const zoomLevelDisplay = document.getElementById('zoom-level');

        function zoomIn() {
            currentZoom += zoomStep;
            updateZoom();
        }

        function zoomOut() {
            currentZoom -= zoomStep;
            if (currentZoom < zoomStep) currentZoom = zoomStep; // Minimum zoom level
            updateZoom();
        }

        function resetZoom() {
            currentZoom = 100;
            updateZoom();
        }

        function updateZoom() {
            document.querySelector('.document').style.zoom = currentZoom / 100;
            zoomLevelDisplay.value = currentZoom + '%';
        }

        // Read Mode and Full Screen (Basic toggles, more sophisticated read mode can be implemented)
        let isReadMode = false;
        function toggleReadMode() {
            isReadMode = !isReadMode;
            const doc = document.querySelector('.document');
            const body = document.body;
            if (isReadMode) {
                doc.style.maxWidth = '90%'; // Wider for read mode
                doc.style.margin = '30px auto';
                doc.style.fontSize = '1.1em'; // Slightly larger font for reading
                doc.style.lineHeight = '1.8';  // Increased line height for readability
                body.style.backgroundColor = '#fafafa'; // Lighter background for read mode
                doc.style.boxShadow = 'none'; // Remove shadow in read mode
                doc.style.border = 'none';     // Remove border in read mode

            } else {
                doc.style.maxWidth = 'none';
                doc.style.margin = '20px';
                doc.style.fontSize = '1em';
                doc.style.lineHeight = '1.6';
                body.style.backgroundColor = '#f4f7f9';
                doc.style.boxShadow = '0 0 10px rgba(0,0,0,0.08)';
                doc.style.border = '1px solid #ccc';
            }
        }

        let isFullScreen = false;
        function toggleFullScreen() {
            if (!isFullScreen) {
                if (document.documentElement.requestFullscreen) {
                    document.documentElement.requestFullscreen();
                } else if (document.documentElement.mozRequestFullScreen) { /* Firefox */
                    document.documentElement.mozRequestFullScreen();
                } else if (document.documentElement.webkitRequestFullscreen) { /* Chrome, Safari and Opera */
                    document.documentElement.webkitRequestFullscreen();
                } else if (document.documentElement.msRequestFullscreen) { /* IE/Edge */
                    document.documentElement.msRequestFullscreen();
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.mozCancelFullScreen) { /* Firefox */
                    document.mozCancelFullScreen();
                } else if (document.webkitExitFullscreen) { /* Chrome, Safari and Opera */
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) { /* IE/Edge */
                    document.msExitFullscreen();
                }
            }
            isFullScreen = !isFullScreen;
        }

        // Export Functionality (Placeholder - actual export needs server-side or libraries)
        function exportDocument(format) {
            if (format === 'docx') {
                alert('Exporting as DOCX (feature placeholder - requires server-side or JS library like mammoth.js)');
                // In a real application, you would use a library or server-side script to convert HTML to DOCX
            } else if (format === 'pdf') {
                alert('Exporting as PDF (feature placeholder - requires server-side or JS library like jsPDF)');
                // Similarly, for PDF export, you'd need a library or server-side rendering
            } else if (format === 'html') {
                saveDocument(); // Re-use saveDocument as export to HTML
            } else if (format === 'txt') {
                const textContent = document.querySelector('.document').textContent;
                const blob = new Blob([textContent], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'document.txt';
                a.click();
                URL.revokeObjectURL(url);
            }
        }

        function printDocument() {
            alert('Print functionality is a placeholder. In a real application, you would use `window.print()` or more advanced printing libraries for better control over print layout.');
            window.print(); // Basic browser print functionality
        }

        // Template Loading and Gallery
        document.addEventListener('DOMContentLoaded', loadTemplates);
        let isTemplateGalleryVisible = false;

        function loadTemplates() {
            const templates = [
                { name: 'Blank Document', content: 'Start typing here...' },
                { name: 'Report Template', content: '<h1>Report Title</h1><p>Introduction...</p>' },
                { name: 'Memo Template', content: '<h2>MEMORANDUM</h2><p>To: ...</p><p>From: ...</p>' },
                { name: 'Resume Template', content: '<h1>[Your Name]</h1><h2>[Your Profession]</h2><p>[Contact Information]</p><hr><h3>Summary</h3><p>[Your Professional Summary]</p><hr><h3>Experience</h3><ul><li>[Job Title] - [Company] - [Dates]</li></ul>' },
                { name: 'Newsletter Template', content: '<h1>[Newsletter Title]</h1><p>Issue Date: [Date]</p><hr><h2>Feature Article</h2><p>[Article Content]</p>' },
                { name: 'Meeting Minutes', content: '<h2>Meeting Minutes</h2><p>Date: [Date]</p><p>Attendees: [List of Attendees]</p><hr><h3>Agenda Items & Discussions</h3><ul><li>[Item 1]: [Discussion Summary]</li></ul>' }
                // Add more templates
            ];
            const templatesDropdown = document.getElementById('templatesDropdown');
            if (templatesDropdown) {
                templatesDropdown.innerHTML = ''; // Clear existing templates
                templates.forEach(template => {
                    const templateButton = document.createElement('button');
                    templateButton.textContent = template.name;
                    templateButton.onclick = () => applyTemplate(template.content);
                    templatesDropdown.appendChild(templateButton);
                });
            }
        }

        function applyTemplate(content) {
            document.querySelector('.document').innerHTML = content;
            hideTemplateGallery(); // Hide gallery after applying template
        }

        function toggleTemplateGallery() {
            const templatesDropdown = document.getElementById('templatesDropdown');
            isTemplateGalleryVisible = !isTemplateGalleryVisible;
            if (isTemplateGalleryVisible) {
                loadTemplateGalleryView();
                templatesDropdown.style.display = 'grid'; // Show as gallery
            } else {
                loadTemplates(); // Revert to dropdown list view
                templatesDropdown.style.display = 'none'; // Hide dropdown
            }
        }

        function hideTemplateGallery() {
            const templatesDropdown = document.getElementById('templatesDropdown');
            templatesDropdown.style.display = 'none';
            isTemplateGalleryVisible = false;
            loadTemplates(); // Revert to dropdown list for next time
        }

        function loadTemplateGalleryView() {
            const templateGalleryDiv = document.getElementById('templatesDropdown');
            if (!templateGalleryDiv) return;

            const templateData = [
                { name: 'Blank', preview: 'blank-template.png', content: 'Start typing here...' },
                { name: 'Report', preview: 'report-template.png', content: '<h1>Report Title</h1><p>Introduction...</p>' },
                { name: 'Memo', preview: 'memo-template.png', content: '<h2>MEMORANDUM</h2><p>To: ...</p><p>From: ...</p>' },
                { name: 'Resume', preview: 'resume-template.png', content: '<h1>[Your Name]</h1><h2>[Your Profession]</h2><p>[Contact Information]</p><hr><h3>Summary</h3><p>[Your Professional Summary]</p><hr><h3>Experience</h3><ul><li>[Job Title] - [Company] - [Dates]</li></ul>' },
                { name: 'Newsletter', preview: 'newsletter-template.png', content: '<h1>[Newsletter Title]</h1><p>Issue Date: [Date]</p><hr><h2>Feature Article</h2><p>[Article Content]</p>' },
                { name: 'Meeting', preview: 'meeting-template.png', content: '<h2>Meeting Minutes</h2><p>Date: [Date]</p><p>Attendees: [List of Attendees]</p><hr><h3>Agenda Items & Discussions</h3><ul><li>[Item 1]: [Discussion Summary]</li></ul>' }
                // ... more templates with preview images and content ...
            ];

            templateGalleryDiv.innerHTML = ''; // Clear dropdown content

            templateData.forEach(template => {
                const templatePreviewDiv = document.createElement('div');
                templatePreviewDiv.className = 'template-preview';
                templatePreviewDiv.onclick = () => applyTemplate(template.content); // Apply template on click

                const templateTitle = document.createElement('h4');
                templateTitle.textContent = template.name;
                templatePreviewDiv.appendChild(templateTitle);

                // Placeholder for preview image (replace 'template.preview' with actual image paths)
                const previewImage = document.createElement('div');
                previewImage.style.width = '100%';
                previewImage.style.height = '100px';
                previewImage.style.backgroundColor = '#eee'; // Placeholder background
                previewImage.style.marginBottom = '5px';
                previewImage.textContent = 'Preview'; // Text placeholder
                templatePreviewDiv.appendChild(previewImage);


                templateGalleryDiv.appendChild(templatePreviewDiv);
            });
        }


        // --- Insert Tab Functions (Placeholders - Implementation needed) ---
        function insertChart() {
            alert('Insert Chart (feature placeholder - requires charting library integration)');
            // Integrate a charting library like Chart.js or similar
        }

        function insertShape() {
            alert('Insert Shape (feature placeholder - requires SVG or canvas integration)');
            // Implement shape drawing using SVG or canvas
        }

        function insertSymbol() {
            const symbol = prompt('Enter symbol to insert:');
            if (symbol) {
                document.execCommand('insertText', false, symbol);
            }
        }

        function insertHeader() {
            alert('Insert Header (feature placeholder - requires header/footer structure)');
            // Implement header/footer structure, possibly using divs outside the main document flow
        }

        function insertFooter() {
            alert('Insert Footer (feature placeholder - requires header/footer structure)');
            // Implement header/footer structure
        }

        function insertPageNumber() {
            alert('Insert Page Number (feature placeholder - requires page layout and numbering logic)');
            // Implement page numbering, likely requiring more complex page layout handling
        }

        function insertPageBreak() {
            document.execCommand('insertParagraph'); // Simple page break simulation
            document.execCommand('insertHorizontalRule'); // Visual break
            document.execCommand('insertParagraph');
            // Proper page break implementation would require more sophisticated layout management
        }
        function insertIcons() { alert('Icons - Placeholder'); }
        function insert3DModel() { alert('3D Models - Placeholder'); }
        function insertExcelSpreadsheet() { alert('Excel Spreadsheet - Placeholder'); }
        function insertCoverPage() { alert('Cover Page - Placeholder'); }
        function insertBlankPage() { alert('Blank Page - Placeholder'); }
        function insertOnlineVideo() { alert('Online Video - Placeholder'); }
        function insertTextBox() { alert('Text Box - Placeholder'); }
        function insertQuickParts() { alert('Quick Parts - Placeholder'); }
        function insertWordArt() { alert('WordArt - Placeholder'); }
        function insertSignatureLine() { alert('Signature Line - Placeholder'); }
        function insertDateAndTime() { alert('Date & Time - Placeholder'); }
        function insertObject() { alert('Object - Placeholder'); }


        // --- Review Tab Functions (Placeholders - Implementation needed) ---
        function checkSpellingAndGrammar() {
            alert('Spelling & Grammar Check (feature placeholder - requires spellcheck/grammar API integration)');
            // Integrate with a spell-checking and grammar API (like LanguageTool API)
        }

        function openThesaurus() {
            alert('Thesaurus (feature placeholder - requires thesaurus API integration)');
            // Integrate with a thesaurus API
        }

        function wordCount() {
            const text = document.querySelector('.document').textContent;
            const words = text.trim().split(/\s+/).filter(word => word).length; // Basic word count
            alert(`Word Count: ${words}`);
        }

        function characterCount() {
            const text = document.querySelector('.document').textContent;
            const characters = text.length; // Basic character count
            alert(`Character Count: ${characters}`);
        }

        function pageCount() {
            alert('Page Count - Placeholder.  Accurate page count in a web environment requires more complex layout and pagination logic.');
            // In a real application, you'd need to implement pagination and page break detection for accurate page counts.
            alert('Page Count: (Placeholder - needs advanced implementation)');
        }
        function documentStats() {
            alert('Document Stats - Placeholder. Would include word count, character count, page count, reading time, etc.');
            wordCount();
            characterCount();
            pageCount(); // Placeholder page count
        }

        function smartLookup() { alert('Smart Lookup - Placeholder (Integrate with Bing or similar for definitions and info)'); }


        let trackChangesEnabled = false;
        let changeLog = []; // To store changes for track changes

        function toggleTrackChanges() {
            trackChangesEnabled = !trackChangesEnabled;
            alert(`Track Changes ${trackChangesEnabled ? 'Enabled' : 'Disabled'}`);
            if (trackChangesEnabled) {
                startTrackingChanges();
            } else {
                stopTrackingChanges();
            }
        }

        function startTrackingChanges() {
            const doc = document.querySelector('.document');
            doc.addEventListener('input', recordChange);
        }

        function stopTrackingChanges() {
            const doc = document.querySelector('.document');
            doc.removeEventListener('input', recordChange);
        }

        function recordChange(event) {
            if (!trackChangesEnabled) return;
            const changeType = event.inputType;
            const targetElement = event.target;
            let changeDetails = {
                type: changeType,
                timestamp: new Date(),
                content: targetElement.innerHTML // Capture current content - could be optimized
            };

            if (changeType === 'insertText') {
                const insertedText = event.data; // Text inserted
                if (insertedText) {
                    const selection = window.getSelection();
                    if (selection.rangeCount) {
                        const range = selection.getRangeAt(0);
                        const newNode = document.createElement('span');
                        newNode.className = 'track-changes-insertion';
                        newNode.textContent = insertedText;
                        range.deleteContents(); // Remove selected content if any
                        range.insertNode(newNode);
                        range.collapse(false); // Collapse range at the end of insertion
                        selection.removeAllRanges();
                        selection.addRange(range);
                    }
                }
            } else if (changeType === 'deleteContentBackward' || changeType === 'deleteContentForward') {
                const selection = window.getSelection();
                if (selection.rangeCount) {
                    const range = selection.getRangeAt(0);
                    const selectedNode = range.startContainer;

                    if (selectedNode.nodeType === Node.TEXT_NODE && range.startOffset < selectedNode.textContent.length) {
                        const deletedText = selectedNode.textContent.substring(range.startOffset, range.endOffset);
                        const span = document.createElement('span');
                        span.className = 'track-changes-highlight';
                        span.textContent = deletedText;
                        range.surroundContents(span); // Surround the deleted text with highlight
                    }
                    // For more complex deletions, more robust tracking is needed (diffing algorithms)
                }
            }


            changeLog.push(changeDetails);
            console.log('Change Log:', changeLog); // For debugging - review changes
        }


        function acceptChanges() {
            alert('Accept Changes (feature placeholder - needs change log implementation)');
            // Logic to iterate through changeLog and permanently apply insertions, remove deletions
            // Could involve removing 'track-changes-insertion' class and deleting 'track-changes-highlight' content
        }

        function rejectChanges() {
            alert('Reject Changes (feature placeholder - needs change log implementation)');
            // Logic to revert changes based on changeLog - potentially reload original document state
        }


        let commentCounter = 1;
        function insertComment() {
            const selection = window.getSelection();
            if (!selection.rangeCount) return;
            const selectedText = selection.toString();
            if (!selectedText) {
                alert('Select text to comment on.');
                return;
            }

            const commentText = prompt('Enter your comment:');
            if (commentText) {
                const commentId = `comment-${commentCounter++}`;
                const commentBubble = document.createElement('span');
                commentBubble.className = 'comment-bubble';
                commentBubble.textContent = commentCounter - 1; // Display comment number
                commentBubble.title = commentText; // Comment text as tooltip

                const range = selection.getRangeAt(0).cloneRange(); // Clone to avoid issues with selection manipulation
                range.collapse(false); // Collapse range to the end of selection
                range.insertNode(commentBubble); // Insert bubble at the end

                // Optionally, you could store comments and their positions for later display/management
                console.log(`Comment "${commentText}" added to: "${selectedText}"`);
                selection.removeAllRanges(); // Clear selection
            }
        }

        function showComments() {
            alert('Show Comments (feature placeholder - needs comment management and display)');
            // Implement a side panel or overlay to display all comments and allow navigation/interaction
        }
        function deleteComment() { alert('Delete Comment - Placeholder'); }
        function previousComment() { alert('Previous Comment - Placeholder'); }
        function nextComment() { alert('Next Comment - Placeholder'); }
        function trackComments() { alert('Track Comments - Placeholder'); }
        function reviewChanges() { alert('Reviewing Pane - Placeholder'); }
        function previousChange() { alert('Previous Change - Placeholder'); }
        function nextChange() { alert('Next Change - Placeholder'); }
        function compareDocuments() { alert('Compare Documents - Placeholder'); }
        function combineDocuments() { alert('Combine Documents - Placeholder'); }
        function protectDocument() { alert('Protect Document - Placeholder'); }
        function restrictEditing() { alert('Restrict Editing - Placeholder'); }
        function startInking() { alert('Start Inking - Placeholder (Canvas or SVG integration needed)'); }
        function inkEraser() { alert('Ink Eraser - Placeholder'); }
        function readingLevel() { alert('Reading Level - Placeholder'); }
        function translateDocument() { alert('Translate Document - Placeholder'); }
        function languageSettings() { alert('Language Settings - Placeholder'); }


        // --- Context Menu ---
        function showContextMenu(event) {
            event.preventDefault(); // Prevent default right-click menu

            const contextMenu = document.getElementById('contextMenu');
            contextMenu.style.display = 'block';
            contextMenu.style.left = event.clientX + 'px';
            contextMenu.style.top = event.clientY + 'px';
        }

        function hideContextMenu() {
            document.getElementById('contextMenu').style.display = 'none';
        }

        document.addEventListener('click', function(event) {
            if (!event.target.closest('#contextMenu') && document.getElementById('contextMenu').style.display === 'block') {
                hideContextMenu();
            }
        });

        function pasteInContextMenu() {
            formatText('paste'); // Re-use existing paste functionality
        }


        // --- Placeholder Functions for other advanced features ---
        function drawTable() { alert('Draw Table - Placeholder'); }
        function insertPredefinedTable() { alert('Quick Tables - Placeholder'); }
        function insertOnlineImage() { alert('Online Pictures - Placeholder'); }
        function insertSmartArt() { alert('SmartArt - Placeholder'); }
        function insertScreenshot() { alert('Screenshot - Placeholder'); }
        function insertBookmark() { alert('Bookmark - Placeholder'); }
        function insertEquation() { alert('Equation - Placeholder'); }
        function insertSectionBreak() { alert('Section Break - Placeholder'); }
        function insertColumnBreak() { alert('Column Break - Placeholder'); }
        function insertTextWrappingBreak() { alert('Text Wrapping Break - Placeholder'); }
        function togglePrintLayout() { alert('Print Layout View - Placeholder'); }
        function toggleWebLayout() { alert('Web Layout View - Placeholder'); }
        function toggleOutlineView() { alert('Outline View - Placeholder'); }
        function toggleDraftView() { alert('Draft View - Placeholder'); }
        function showRuler() { alert('Ruler - Placeholder'); }
        function showGridlines() { alert('Gridlines - Placeholder'); }
        function showNavigationPane() { alert('Navigation Pane - Placeholder'); }
        function showStatusBar() { alert('Status Bar - Placeholder'); }
        function newWindow() { alert('New Window - Placeholder'); }
        function arrangeWindows() { alert('Arrange All Windows - Placeholder'); }
        function splitWindow() { alert('Split Window - Placeholder'); }
        function viewSideBySide() { alert('View Side by Side - Placeholder'); }
        function synchronousScrolling() { alert('Synchronous Scrolling - Placeholder'); }
        function resetWindowPosition() { alert('Reset Window Position - Placeholder'); }
        function switchWindows() { alert('Switch Windows - Placeholder'); }
        function recordMacro() { alert('Record Macro - Placeholder'); }
        function viewMacros() { alert('View Macros - Placeholder'); }
        function checkAccessibility() { alert('Accessibility Checker - Placeholder'); }
        function accessibilitySettings() { alert('Accessibility Settings - Placeholder'); }
        function mailMerge() { alert('Mail Merge - Placeholder'); }
        function envelopes() { alert('Envelopes - Placeholder'); }
        function labels() { alert('Labels - Placeholder'); }
        function getAddIns() { alert('Get Add-ins - Placeholder'); }
        function myAddIns() { alert('My Add-ins - Placeholder'); }
        function optionsDialog() { alert('Options Dialog - Placeholder'); }
        function customizeRibbon() { alert('Customize Ribbon - Placeholder'); }
        function keyboardShortcuts() { alert('Keyboard Shortcuts - Placeholder'); }
        function showParagraphSettings() { alert('Paragraph Options - Placeholder'); }
        function showBordersAndShading() { alert('Borders & Shading - Placeholder'); }
        function formatPainter() { alert('Format Painter - Placeholder'); }
        function selectAll() { document.execCommand('selectAll', false, null); }
        function goToLine() { alert('Go To Line - Placeholder'); }
        function convertToPDF() { exportDocument('pdf'); } // Re-use export for conversion placeholders
        function convertToDOCX() { exportDocument('docx'); }
        function convertToHTML() { exportDocument('html'); }
        function convertToPlainText() { exportDocument('txt'); }
        function storeLink() { alert('Store - Placeholder for Add-in Store Link'); }
        function wikipediaLink() { alert('Wikipedia - Placeholder for Wikipedia Integration'); }
        function shareDocument() { alert('Share Document - Placeholder (Collaboration features needed)'); }
        function collaborateRealtimeToggle() { alert('Real-time Collaboration Toggle - Placeholder'); }
        function inviteCollaborator() { alert('Invite Collaborator - Placeholder'); }
        function managePermissions() { alert('Manage Permissions - Placeholder'); }
        function trackCollaborators() { alert('Track Collaborators - Placeholder'); }
        function startCoAuthoringSession() { alert('Start Co-authoring Session - Placeholder'); }
        function joinCoAuthoringSession() { alert('Join Co-authoring Session - Placeholder'); }
        function versionHistory() { alert('Version History - Placeholder'); }
        function autosaveToggle() { alert('Autosave Toggle - Placeholder'); }
        function manualBackup() { alert('Manual Backup - Placeholder'); }
        function cloudSyncToggle() { alert('Cloud Sync Toggle - Placeholder'); }

        function changeTextCase(caseType) {
            const selection = window.getSelection();
            if (!selection.rangeCount) return;
            const range = selection.getRangeAt(0);
            const selectedText = selection.toString();
            let newText;

            if (caseType === 'uppercase') {
                newText = selectedText.toUpperCase();
            } else if (caseType === 'lowercase') {
                newText = selectedText.toLowerCase();
            }

            if (newText !== undefined) {
                range.deleteContents();
                range.insertNode(document.createTextNode(newText));
            }
        }


        // --- AI Tools Functions (Placeholders - AI Integration Needed) ---
        let smartComposeEnabled = false;
        function smartComposeToggle() {
            smartComposeEnabled = !smartComposeEnabled;
            document.getElementById('smartComposeStatus').textContent = `(${smartComposeEnabled ? 'On' : 'Off'})`;
            if (smartComposeEnabled) {
                startSmartCompose();
            } else {
                stopSmartCompose();
            }
        }

        function startSmartCompose() {
            document.querySelector('.document').addEventListener('input', handleSmartCompose);
        }

        function stopSmartCompose() {
            document.querySelector('.document').removeEventListener('input', handleSmartCompose);
            clearSmartComposeHighlight();
        }

        let currentSuggestionSpan = null; // To track the current suggestion highlight

        function handleSmartCompose(event) {
            if (!smartComposeEnabled) return;

            const text = document.querySelector('.document').textContent;
            // Basic placeholder AI suggestion logic - replace with actual AI API call
            const lastWord = text.trim().split(/\s+/).pop() || '';
            let suggestion = '';

            if (lastWord.toLowerCase() === 'the') {
                suggestion = 'quick brown fox jumps over the lazy dog.';
            } else if (lastWord.toLowerCase() === 'in') {
                suggestion = 'order to improve performance...';
            } else if (lastWord.toLowerCase() === 'for') {
                suggestion = 'example, consider the following...';
            }
             else if (lastWord.toLowerCase() === 'web') {
                suggestion = 'word processor is advanced and innovative.';
            }


            if (suggestion) {
                showAISuggestion(suggestion);
            } else {
                hideAISuggestion();
            }
        }

        function showAISuggestion(suggestionText) {
            hideAISuggestion(); // Clear any previous suggestion

            const selection = window.getSelection();
            if (!selection.rangeCount) return;
            const range = selection.getRangeAt(0).cloneRange();
            range.collapse(false); // Collapse to end

            const suggestionSpan = document.createElement('span');
            suggestionSpan.className = 'smart-compose-highlight';
            suggestionSpan.textContent = suggestionText;

            // Store the span for potential removal later
            currentSuggestionSpan = suggestionSpan;

            range.insertNode(suggestionSpan);
            // Move cursor to end of inserted text
            range.collapse(false);
            selection.removeAllRanges();
            selection.addRange(range);

            // Add event listener to accept suggestion on Tab press
            document.addEventListener('keydown', acceptSuggestionOnTab);
        }


        function hideAISuggestion() {
            if (currentSuggestionSpan && currentSuggestionSpan.parentNode) {
                currentSuggestionSpan.parentNode.removeChild(currentSuggestionSpan);
                currentSuggestionSpan = null;
            }
            document.removeEventListener('keydown', acceptSuggestionOnTab);
        }

        function clearSmartComposeHighlight() {
             if (currentSuggestionSpan && currentSuggestionSpan.parentNode) {
                const textNode = document.createTextNode(currentSuggestionSpan.textContent);
                currentSuggestionSpan.parentNode.replaceChild(textNode, currentSuggestionSpan);
                currentSuggestionSpan = null;
            }
             document.removeEventListener('keydown', acceptSuggestionOnTab);
        }


        function acceptSuggestionOnTab(event) {
            if (event.key === 'Tab') {
                event.preventDefault(); // Prevent tab from moving focus
                acceptAISuggestion();
            }
        }

        function acceptAISuggestion() {
            if (currentSuggestionSpan) {
                const suggestionText = currentSuggestionSpan.textContent;
                const range = document.createRange();
                range.setStartAfter(currentSuggestionSpan);
                range.collapse(true);
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);

                clearSmartComposeHighlight(); // Remove highlight, keep text
            }
        }


        function grammarCheckAI() { alert('AI Grammar Check - Placeholder (Integrate with Grammar AI API)'); }
        function styleSuggestionsAI() { alert('Style Suggestions - Placeholder (Style AI API)'); }
        function summarizeTextAI() { alert('Summarize Text - Placeholder (Summarization AI API)'); }
        function translateAI() { alert('Translate with AI - Placeholder (Translation AI API)'); }
        function contentRewriteAI() { alert('Rewrite Content - Placeholder (Content Rewriting AI API)'); }
        function toneAdjustAI() { alert('Adjust Tone - Placeholder (Tone Analysis AI API)'); }
        function researchAI() { alert('Research - Placeholder (Knowledge Graph/Search AI API)'); }
        function ideasAI() { alert('Ideas & Suggestions - Placeholder (Content Generation AI API)'); }

        function summarizeSelectionAI() {
            const selection = window.getSelection();
            const selectedText = selection.toString();
            if (!selectedText) {
                alert('Select text to summarize.');
                return;
            }
            alert('AI Summarize: (Placeholder for AI summarization of: "' + selectedText + '")');
        }

        function translateSelectionAI() {
            const selection = window.getSelection();
            const selectedText = selection.toString();
            if (!selectedText) {
                alert('Select text to translate.');
                return;
            }
            alert('AI Translate: (Placeholder for AI translation of: "' + selectedText + '")');
        }


        // --- Collaboration Features (Placeholders - Real-time features require backend) ---
        let realtimeCollaborationEnabled = false;
        function collaborateRealtimeToggle() {
            realtimeCollaborationEnabled = !realtimeCollaborationEnabled;
            document.getElementById('realtimeStatus').textContent = `(${realtimeCollaborationEnabled ? 'On' : 'Off'})`;
            if (realtimeCollaborationEnabled) {
                startRealtimeCollaboration();
            } else {
                stopRealtimeCollaboration();
            }
        }

        function startRealtimeCollaboration() {
            alert('Real-time Collaboration Started - Placeholder. This would involve connecting to a server using WebSockets or similar for real-time synchronization of document changes.');
            // Initialize WebSocket connection, start sending document changes, and listening for changes from other collaborators.
            document.querySelector('.document').addEventListener('input', sendDocumentChange);
            document.querySelector('.document').addEventListener('selectionchange', sendCursorPosition); // Track cursor
        }

        function stopRealtimeCollaboration() {
            alert('Real-time Collaboration Stopped - Placeholder. Close WebSocket connection and stop sending/receiving updates.');
            // Close WebSocket connection, stop sending and receiving updates.
            document.querySelector('.document').removeEventListener('input', sendDocumentChange);
            document.querySelector('.document').removeEventListener('selectionchange', sendCursorPosition);
        }

        function sendDocumentChange(event) {
            if (!realtimeCollaborationEnabled) return;
            // Send the document change (event details or diff) to the server via WebSocket.
            console.log('Document Change:', event); // Placeholder - send actual data
            // Example: websocket.send(JSON.stringify({ type: 'documentChange', data: event.data, ... }));
        }

        function sendCursorPosition() {
            if (!realtimeCollaborationEnabled) return;
            const selection = window.getSelection();
            if (selection.rangeCount) {
                const range = selection.getRangeAt(0);
                // Calculate cursor position relative to document - more complex in real implementation
                const cursorInfo = { startOffset: range.startOffset, endOffset: range.endOffset };
                console.log('Cursor Position:', cursorInfo); // Placeholder - send actual data
                // Example: websocket.send(JSON.stringify({ type: 'cursorPosition', cursor: cursorInfo, ... }));
            }
        }

        // Placeholder for handling remote cursor positions and displaying collaborator cursors.
        function handleRemoteCursor(collaboratorId, cursorInfo) {
            // In a real implementation, you would:
            // 1.  Create or update a visual cursor element for each collaborator (using CSS absolute positioning).
            // 2.  Position the cursor element based on cursorInfo (which would need to be translated to pixel coordinates in the document).
            // 3.  Potentially display a name tag above the cursor for each collaborator.
            console.log(`Remote Cursor from ${collaboratorId}:`, cursorInfo);
            // Example placeholder for adding a cursor element (simplified):
            const cursorContainer = document.getElementById('collaboratorCursors');
            let cursorElement = document.getElementById(`cursor-${collaboratorId}`);
            if (!cursorElement) {
                cursorElement = document.createElement('div');
                cursorElement.id = `cursor-${collaboratorId}`;
                cursorElement.className = 'collaborator-cursor';
                const nameTag = document.createElement('div');
                nameTag.className = 'collaborator-name-tag';
                nameTag.textContent = `User ${collaboratorId.slice(0, 4)}`; // Shortened ID for tag
                cursorElement.appendChild(nameTag);
                cursorContainer.appendChild(cursorElement);
            }
            // In a real implementation, you would calculate and set cursorElement.style.left and cursorElement.style.top based on cursorInfo and document layout.
            cursorElement.style.left = '100px'; // Example positioning - replace with calculated position
            cursorElement.style.top = '150px';
        }

        // Example call to simulate receiving a remote cursor update (for testing placeholder UI):
        // setTimeout(() => handleRemoteCursor('user12345', { startOffset: 50, endOffset: 50 }), 2000);


        // --- Autosave and Cloud Sync placeholders ---
        let autosaveEnabled = true; // Default autosave on
        document.getElementById('autosaveStatus').textContent = '(On)';

        function autosaveToggle() {
            autosaveEnabled = !autosaveEnabled;
            document.getElementById('autosaveStatus').textContent = `(${autosaveEnabled ? 'On' : 'Off'})`;
            alert(`Autosave ${autosaveEnabled ? 'Enabled' : 'Disabled'} - Placeholder. In a real app, document would be saved automatically in intervals.`);
            // Implement autosave logic (e.g., using localStorage, IndexedDB, or server-side saving at intervals).
        }

        let cloudSyncEnabled = false;
        function cloudSyncToggle() {
            cloudSyncEnabled = !cloudSyncEnabled;
            document.getElementById('cloudSyncStatus').textContent = `(${cloudSyncEnabled ? 'On' : 'Off'})`;
            alert(`Cloud Sync ${cloudSyncEnabled ? 'Enabled' : 'Disabled'} - Placeholder. Would sync document to cloud storage (Google Drive, OneDrive etc.).`);
            // Implement cloud sync logic (e.g., using cloud storage APIs to sync document).
        }

        function manualBackup() {
            alert('Manual Backup - Placeholder. Would allow user to create a manual backup of the document.');
            // Implement manual backup logic (e.g., saving a version to local storage or downloading a backup file).
        }


        function handleDocumentInput(event) {
            if (autosaveEnabled) {
                // Placeholder for autosave logic - save after each input or after a short delay
                console.log('Autosaving... (Placeholder)');
                // Real autosave logic would go here
            }
            if (smartComposeEnabled) {
                // Trigger smart compose suggestion on input (already handled in handleSmartCompose function)
            }
            if (realtimeCollaborationEnabled) {
                // Send document change to collaborators (already handled in sendDocumentChange function)
            }
        }


    </script>
</body>
</html>
